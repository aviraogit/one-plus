(window.webpackJsonp=window.webpackJsonp||[]).push([["product2077/flashSale"],{"15rc":function(t,s,i){},"Aa/g":function(t,s,i){"use strict";i.r(s);i("fp7Y");var n=i("yGUf"),e=i.n(n),o=i("fu9z"),a=i.n(o),l=i("Pyhl"),c={props:{flashSale:{type:Object,default:function(){return{}}},originPrice:{type:[Number,String],default:0}},data:function(){return{onGoing:!1,shortStock:!1,activityCode:"",timer:null,countDownTime:0,sessionInfo:null,stockAmt:0,flashSalePrice:"",disable:!1}},computed:{startTime:function(){var t=this.sessionInfo.sessionStartTime;return t-(new Date).getTime()>36e5?e.a.formatDate(t):0},countDownTimeText:function(){var t=parseInt(this.countDownTime/86400),s=parseInt(this.countDownTime/3600)%24,i=parseInt(this.countDownTime/60)%60,n=this.countDownTime%60;return{day:t>9?t:t>0?"0"+t:"",hour:s>9?s:s>0?"0"+s:"",min:i>9?i:i>0?"0"+i:"00",sec:n>9?n:"0"+n}},savePercent:function(){if(this.sessionInfo){var t,s=(null===(t=this.sessionInfo.flashSaleGoodsVO)||void 0===t?void 0:t.discountAmount)||0;return this.getPercent(s,this.originPrice)}return""},redTime:function(){return this.countDownTime<=600&&this.onGoing}},watch:{flashSale:{deep:!0,immediate:!0,handler:function(){var t,s,i,n,e,o,l,c,r;null!==(t=this.flashSale)&&void 0!==t&&t.currentSession?this.sessionInfo=this.flashSale.currentSession:null!==(s=this.flashSale)&&void 0!==s&&s.nextSession?this.sessionInfo=this.flashSale.nextSession:this.sessionInfo=null,this.activityCode=null===(i=this.sessionInfo)||void 0===i?void 0:i.activityCode;var u=(new Date).getTime(),h=null===(n=this.sessionInfo)||void 0===n?void 0:n.sessionStartTime,f=null===(e=this.sessionInfo)||void 0===e?void 0:e.sessionEndTime;h-u>36e5&&(this.sessionInfo=null),this.stockAmt=(null===(o=this.sessionInfo)||void 0===o?void 0:null===(l=o.flashSaleGoodsVO)||void 0===l?void 0:l.availableStock)||0,this.flashSalePrice=a.a.misc.formatCurrency((null===(c=this.sessionInfo)||void 0===c?void 0:null===(r=c.flashSaleGoodsVO)||void 0===r?void 0:r.discountAmount)||0),this.shortStock=this.stockAmt<Number(this.$t("flashSale.shortStockAmt"))&&this.stockAmt>0,u<h?(this.onGoing=!1,this.countDownTime=parseInt((h-u)/1e3),this.disable=!1):(this.onGoing=!0,this.countDownTime=parseInt((f-u)/1e3),this.disable=0===this.stockAmt)}},countDownTime:{handler:function(t,s){this.clearTimer(),this.start()}}},methods:{start:function(){var t=this;this.clearTimer(),this.countDownTime<=0||(this.timer=setInterval((function(){if(t.countDownTime--,t.countDownTime<=0){if(t.onGoing)return t.disable=!0,a.a.bus.$emit("change-can-buy",!1),t.end();var s;t.onGoing=!0;var i=(null===(s=t.sessionInfo)||void 0===s?void 0:s.sessionEndTime)||0;return t.countDownTime=parseInt((i-(new Date).getTime())/1e3),a.a.bus.$emit("change-can-buy",!0),t.start()}}),1e3))},end:function(){this.clearTimer()},clearTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},getPercent:function(t,s){if(s){var i=Math.round((Number(s)-Number(t))/Number(s)*100);return(0==i?1:100==i?99:i)+"%"}return""},clickFlashSaleBanner:function(){Object(l.j)("product_flash_sale_banner")}}},r=(i("OvCe"),i("psIG")),u=Object(r.a)(c,(function(){var t=this,s=t.$createElement,i=t._self._c||s;return t.sessionInfo?i("a",{staticClass:"product-station__flash__banner",class:{disable:t.disable},attrs:{href:t.$t("flashSale.activityUrl")+t.activityCode},on:{click:t.clickFlashSaleBanner}},[i("div",{staticClass:"product-station__flash__header flex"},[i("div",{staticClass:"product-station__flash__left font-body-1"},[i("img",{staticClass:"flash_icon",attrs:{src:t.$t("flashSale.iconLink")}}),t._v(" "),t.savePercent?i("span",{staticClass:"product-station__flash__left__text font-note-sm"},[t._v(t._s(t.$t("flashSale.savePercent",{amt:t.savePercent})))]):t._e()]),t._v(" "),i("i",{staticClass:"ico ico-arrow-right "})]),t._v(" "),i("div",{staticClass:"product-station__flash__text"},[t.onGoing?t._e():i("p",{staticClass:"product-station__flash__price font-subheading-lg"},[t._v("\n      "+t._s(t.$t("flashSale.price"))),i("span",{staticClass:"text"},[t._v(t._s(t.flashSalePrice))])]),t._v(" "),!t.stockAmt&&t.onGoing?i("div",[t._v("\n      "+t._s(t.$t("flashSale.noStock"))+"\n    ")]):i("div",{staticClass:"product-station__flash__time"},[i("div",{staticClass:"flash__time__left font-body-md"},[i("span",[t._v(t._s(t.onGoing||t.disable?t.$t("flashSale.endsIn"):t.$t("flashSale.startIn")))]),t._v(" "),i("div",{staticClass:"count-down",class:t.redTime?"red":""},[t.countDownTimeText.day?[i("span",{staticClass:"time-bg"},[t._v(t._s(t.countDownTimeText.day)+"d|")])]:t._e(),t._v(" "),t.countDownTimeText.hour?[i("span",{staticClass:"time-bg"},[t._v(t._s(t.countDownTimeText.hour)+"h:")])]:t._e(),t._v(" "),i("span",{staticClass:"time-bg"},[t._v(" "+t._s(t.countDownTimeText.min)+"m:")]),t._v(" "),i("span",{staticClass:"time-bg"},[t._v(t._s(t.countDownTimeText.sec)+"s")])],2)]),t._v(" "),t.shortStock&&t.onGoing&&!t.disable?i("div",{staticClass:"short-availableStock font-body-md"},[t._v("\n        "+t._s(t.$t("flashSale.shortStock",{amt:t.stockAmt}))+"\n      ")]):t._e()])])]):t._e()}),[],!1,null,"05903754",null);s.default=u.exports},OvCe:function(t,s,i){"use strict";var n=i("15rc");i.n(n).a}}]);