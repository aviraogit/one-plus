(window.webpackJsonp=window.webpackJsonp||[]).push([["product2077/availableStore"],{GVnM:function(t,e,i){"use strict";var s=i("hDbR");i.n(s).a},ZOQe:function(t,e,i){"use strict";var s=i("bbA2");i.n(s).a},bbA2:function(t,e,i){},hDbR:function(t,e,i){},nYm8:function(t,e,i){"use strict";i.r(e);i("lYjL"),i("IlJM"),i("fp7Y"),i("JBxO"),i("FdtR"),i("aZFp"),i("SgDD"),i("3dw1");var s=i("fu9z"),o=i.n(s),n=(i("ZEAQ"),{components:{pickUpStoreDialog:function(t){return i.e("product2077/pickUpStoreDialog").then(function(){return t(i("cMwg").default)}.bind(null,i)).catch(i.oe)},storeDetailDialog:function(t){return i.e("product2077/storeDetailDialog").then(function(){return t(i("g/Uu").default)}.bind(null,i)).catch(i.oe)},"one-button":i("Zb5R").default},props:{selectedPhone:{type:[String,Number],default:""},storeList:{type:Array,default:function(){return[]}},pincodeStoreList:{type:Array,default:function(){return[]}},isTradeIn:{type:Boolean,default:!1}},data:function(){return{storeInfo:null,pop:{storePopInit:!1,storePopVisible:!1,pickUpPopInit:!1,pickUpPopVisible:!1}}},computed:{setStoreList:function(){return this.pincodeStoreList},storeShowInfo:function(){var t=this.pincodeStoreList,e=this.storeInfo||t[0];return{storeName:e.inventoryRetailSkuInfo.storeName,outStock:e.skuInventoryStatus.outStock,isDelivery3h:e.inventoryRetailSkuInfo.deliverySupport&&e.inventoryRetailSkuInfo.coverUserPinCode,storeCode:e.inventoryRetailSkuInfo.storeCode}}},methods:{setNearestStore:function(t){return t.nearest=!0},toDistance:function(t){return(Number(t)/1e3).toFixed(2)+this.$t("pickUpText.km")},clickHanderShowDialog:function(){this.pop.pickUpPopInit=!0,this.pop.pickUpPopVisible=!0},changeSotreDetail:function(t){this.storeInfo=null!=t&&t.inventoryRetailSkuInfo?t:null},showStoreDetail:function(){this.pop.storePopInit=!0,this.pop.storePopVisible=!0}}}),r=(i("GVnM"),i("psIG")),a=Object(r.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"pickup-store"},[i("div",{staticClass:"pickup-store-content"},[i("div",{staticClass:"pickup-store flex flex-content-between flex-align-center"},[t.isTradeIn?i("div",{staticClass:"store-msg flex"},[t._m(1),t._v(" "),i("div",{staticClass:"store-title store-title-unable font-body-md flex"},[t._v("\n          "+t._s(t.$t("pickUpText.UnableToPickup"))+">\n        ")])]):i("div",{staticClass:"store-msg"},[i("div",{staticClass:"flex store-info"},[t._m(0),t._v(" "),i("div",[i("div",{staticClass:"title font-body-md"},[t._v("\n              "+t._s(t.$t("pickUpText.availablePickup"))+"\n            ")]),t._v(" "),i("div",{staticClass:"store-title font-body-xl flex"},[t._v("\n              "+t._s(t.storeShowInfo.storeName)+"\n            ")])])]),t._v(" "),i("div",{staticClass:"store-label-list"},[t.storeShowInfo.outStock?i("span",{staticClass:"store-label font-note-sm out-of-stock"},[t._v("\n            "+t._s(t.$t("pickUpText.noStock"))+"\n          ")]):i("span",{staticClass:"store-label font-note-sm"},[t._v("\n            "+t._s(t.$t("pickUpText.inStock"))+"\n          ")])]),t._v(" "),i("div",{staticClass:"opration-button-box flex"},[i("div",{staticClass:"detail-btn",on:{click:t.showStoreDetail}},[i("one-button",{attrs:{type:"link"}},[i("i",{staticClass:"ico ico-icon-tel"}),t._v("\n\n              "+t._s(t.$t("pickUpText.contactStore"))+"\n            ")])],1),t._v(" "),i("div",{staticClass:"all-store-btn flex",on:{click:t.clickHanderShowDialog}},[i("i",{staticClass:"ico ico-place"}),t._v(" "),i("one-button",{attrs:{type:"link"}},[t._v("\n              "+t._s(t.$t("pickUpText.seeAllStore"))+"\n            ")])],1)])])])]),t._v(" "),t.pop.pickUpPopInit?i("pick-up-store-dialog",{ref:"pickUpStoreDialog",staticClass:"store-dialog",attrs:{"store-list":t.setStoreList,"store-selected-code":t.storeShowInfo.storeCode,"is-slected":!1},on:{"selected-store":t.changeSotreDetail},model:{value:t.pop.pickUpPopVisible,callback:function(e){t.$set(t.pop,"pickUpPopVisible",e)},expression:"pop.pickUpPopVisible"}}):t._e(),t._v(" "),t.pop.storePopInit?i("store-detail-dialog",{ref:"storeDetailvialog",attrs:{"store-detail-data":t.storeInfo?t.storeInfo:t.pincodeStoreList[0]},model:{value:t.pop.storePopVisible,callback:function(e){t.$set(t.pop,"storePopVisible",e)},expression:"pop.storePopVisible"}}):t._e()],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"icon"},[e("i",{staticClass:"icon-pickup font-body-md"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"flex-align-center flex"},[e("i",{staticClass:"icon-pickup icon-pickup-unable font-body-1 "})])}],!1,null,"a5402ee0",null).exports,c=i("vBp9"),l=i("Pyhl"),d=i("NUKc"),p=i("yGUf"),u=i("C6ek"),f=i("C6ek"),h=i("Ikje"),v={components:{nearbyStore:a},props:{userAddressInfo:{type:Object,default:function(){}},salesInfoData:{type:Object,default:function(){}},isSupportOmo:{type:Boolean,default:!1},isDepositIn:{type:Object,default:function(){}},productInfo:{type:Object,default:function(){}}},data:function(){return{format:{hh:" hrs and ",mm:" mins "},cutOffTime:0,ssFlag:!0,userPincode:"",skuItemsList:{},iconList:["house","email","cart"],position:{},retailStoreList:[],pincodeRetailStoreList:[],isUnfold:!1,pincodeValid:!0,hintText:this.$t("pickUpText.postcode-require-in"),resultShipping:"",surpportThreeHourDelivery:!1,ThreeHourDeliveryCutTime:0,ThreeHourDeliveryETATime:0,isThreeHourTomorrow:!1,isCutoffTimeTomorrow:!1,hr:25,shippingList:[],timeDownFlag:!1,cityName:"",appAddress:"",hasFinishTradein:!1,isApp:u.isInStoreAppEnv,duringDeposit:!1,depositEtaText:"",formatEndTime:d.c}},computed:{selectedPhone:function(){var t;return null===(t=this.$parent)||void 0===t?void 0:t.skuCode},verifyValid:function(){var t=this.$refs.pickUpPincode;return t.isField&&t.validate()},getSelectDelivery:function(){var t=this,e={};return this.selectedPhone&&this.skuItemsList[this.selectedPhone]&&this.$t("pickUpText.deliveMethodList").forEach((function(i){e[i]=t.skuItemsList[t.selectedPhone][i]})),this.showEtaList(this.skuItemsList[this.selectedPhone]),e},selectSkuStoreList:function(){var t=this;return Array.isArray(this.retailStoreList)?this.retailStoreList.reduce((function(e,i){var s,o=null===(s=i.inventorySkuStatusList)||void 0===s?void 0:s.find((function(e){return e.skuCode===t.selectedPhone}));return o&&e.push({inventoryRetailSkuInfo:i.inventoryRetailSkuInfo,skuInventoryStatus:o}),e}),[]).sort((function(t,e){return t.skuInventoryStatus.outStock-e.skuInventoryStatus.outStock})):[]},selectSkuPincodeStoreList:function(){var t=this;if(!Array.isArray(this.pincodeRetailStoreList))return[];var e=[],i=this.pincodeRetailStoreList.reduce((function(e,i){var s=Array.isArray(i.inventorySkuStatusList)&&i.inventorySkuStatusList.find((function(e){return e.skuCode===t.selectedPhone}));return s&&e.push({inventoryRetailSkuInfo:i.inventoryRetailSkuInfo,skuInventoryStatus:s}),e}),[]);return i&&i.length>0&&i.forEach((function(t){t.skuInventoryStatus&&!t.skuInventoryStatus.outStock&&e.push(t)})),e&&e.length>0?e:[]},isSupportDelivery:function(){return this.getSelectDelivery.deliveryOfflineSupport||this.getSelectDelivery.deliveryOnlineSupport},etdTime:function(){var t="";if(this.selectedPhone&&this.skuItemsList[this.selectedPhone]){var e=this.skuItemsList[this.selectedPhone].etd,i=(new Date).getTime()+24*e*3600*1e3;if(e<0)t=this.$t("product.estimateDowngrade");else if(e<=1&&e>=0)t=this.$t("product.tomorrow");else if(e<=60&&e>1){var s=Object(p.formatDate)(i,!1,!0);t=s.week+", "+s.month+" "+s.day}else t=this.$t("product.inMonths")}return t},etaTime:function(){var t="";if(this.surpportThreeHourDelivery&&this.ThreeHourDeliveryETATime){var e=Object(p.formatDate)(this.ThreeHourDeliveryETATime,!1,!0);return t=e.minute>0?23==e.fullHour?"0:00 tomorrow":Number(e.fullHour)+1+":00 "+(this.isThreeHourTomorrow?"tomorrow":"today"):e.fullHour+":00 "+(this.isThreeHourTomorrow?"tomorrow":"today")}if(this.resultShipping){var i=Object(p.formatDate)(this.resultShipping,!1,!0);t=i.week+", "+i.month+" "+i.day}return t},isSupportCod:function(){return this.$parent.isSupportCod}},watch:{userAddressInfo:{handler:function(t){t&&t.pincode&&(this.updateAddressDialogPincode(t.pincode),this.getAddressDialogAddress(t.city||""))},deep:!0,immediate:!0},salesInfoData:function(t){this.successCallBack(t)},userPincode:{handler:function(t){this.pincodeValid=!0,this.hintText=this.$t("pickUpText.postcode-require-in"),"in"===o.a.site.store&&Object(l.C)(t,this.productInfo)}},isDepositIn:function(t,e){this.depositPayInEta(t)}},mounted:function(){this.getAppInfo(),this.successCallBack(this.salesInfoData),f.isInStoreAppEnv?this.getAppSaveCode():this.checkHasSavePincode(),this.depositPayInEta(this.isDepositIn)},methods:{showAddress:function(){u.isInStoreAppEnv?Object(u.storeAppShowAddressDialog)():this.$emit("pop-address"),Object(l.d)()},getAppSaveCode:function(){var t=Object(u.storeAppGetAddressinfo)()||"";this.appAddress=t;var e=t.split(",")[1]&&t.split(",")[1].trim();e&&this.updateAddressDialogPincode(e)},init:function(){h.insertGMap(),this.getPincodeByLoation()},getPincodeByLoation:function(){var t=this;this.getCurrentPosition().then((function(e){t.position=e,setTimeout((function(){window.google&&h.geocoderLatLng(new google.maps.LatLng(e.latitude,e.longitude),t.onComplete,t.onError)}),1e3)})).catch((function(){o.a.methods.isSignIn()&&t.getUserDefaultAddress()}))},onComplete:function(t){var e=this,i=!1,s=t.filter((function(t){return!t.types.indexOf("street_address")}));s[0]&&s[0].address_components.forEach((function(t){t.types.some((function(t){return"postal_code"===t}))&&(e.getPincodeValue(t.long_name||t.short_name),i=!0)})),!i&&o.a.methods.isSignIn()&&this.getUserDefaultAddress()},onError:function(t){Error(t),o.a.methods.isSignIn()&&this.getUserDefaultAddress()},getUserDefaultAddress:function(){var t=this,e=o.a.site.store.toUpperCase(),i=[],s={storeViewCode:o.a.site.store};Object(c.getUserAddressMall)(s).then((function(s){var o=s.ret,n=s.data;s.errCode;1===Number(o)&&n&&n.addressInfoList&&n.addressInfoList.length>0&&(n.addressInfoList.forEach((function(t){t.countryCode===e&&i.push(t)})),i&&i.length>0&&i.forEach((function(e){e.isDefault&&e.postcode&&(window.localStorage.setItem("addressDialogPincode",e.postcode),window.localStorage.setItem("addressDialogCity",e.city||""),t.getAddressDialogPincode(e.postcode),t.getAddressDialogAddress(e.city||""))})))}))},hasFinishTradeIn:function(t){this.hasFinishTradein=!!t},checkHasSavePincode:function(){var t=window.localStorage.getItem("addressDialogPincode"),e=window.localStorage.getItem("addressDialogCity");t&&(this.updateAddressDialogPincode(t),this.getAddressDialogAddress(e))},getAddressDialogPincode:function(t,e){this.cityName="",this.isUnfold=!0,this.userPincode=t;var i=null==e?void 0:e.lat,s=null==e?void 0:e.lng;i&&s&&(this.$set(this.position,"latitude",i),this.$set(this.position,"longitude",s)),this.clickHanderCheckPincode("verify")},updateAddressDialogPincode:function(t){this.cityName="",this.isUnfold=!0,this.userPincode=t},getAddressDialogAddress:function(t){this.cityName=t||""},getPincodeValue:function(t){this.isUnfold=!0,this.userPincode=t,this.clickHanderCheckPincode("verify")},clickHanderCheckPincode:function(t){if("verify"===t||this.verifyValid)return this.queryPincodeAvailable(),void Object(l.d)();this.retailStoreList=[],this.pickUpRetailStore=[],this.skuItemsList={}},depositPayInEta:function(t){t?(this.duringDeposit=!0,"number"!=typeof t.activityShippingInfo&&""!==t.activityShippingInfo?this.depositEtaText=t.activityShippingInfo:this.depositEtaText=""):this.duringDeposit=!1},successCallBack:function(t){var e=this,i=null==t?void 0:t.data,s=this;i&&(s.skuItemsList=i.items,s.retailStoreList=i.retailStore||[],s.pincodeRetailStoreList=i.pickUpRetailStore||[],s.timeDownFlag=!0,s.showEtaList(s.skuItemsList[s.selectedPhone]),this.$emit("newest-info-in",s.skuItemsList[s.selectedPhone]),s.$nextTick((function(){s.selectSkuStoreList.length||e.isSupportDelivery||(s.pincodeValid=!1,s.hintText=s.$t("pickUpText.undeliverable-desc")),s.$refs.nearbyStoreBox&&s.$refs.nearbyStoreBox.changeSotreDetail(s.selectSkuPincodeStoreList)})))},showEtaList:function(t){this.surpportThreeHourDelivery=!1,this.isThreeHourTomorrow=!1,this.ThreeHourDeliveryCutTime=0,this.ThreeHourDeliveryETATime=0,this.pincodeValid=!0;var e=this,i=0;if(t){if(e.shippingList=t.shippingList,!(e.shippingList&&e.shippingList.length>0))return e.pincodeValid=!1,e.hintText=e.$t("pickUpText.noShippingList"),!1;var s,o;e.shippingList.forEach((function(t){4===t.shippingType?(e.surpportThreeHourDelivery=!0,e.ThreeHourDeliveryCutTime=t.cutOffTime||0,e.ThreeHourDeliveryETATime=t.eta||0,i=t.cutOffTime||0,e.isThreeHourTomorrow=Object(p.checkIsTomorrow)(t.eta),e.isCutoffTimeTomorrow=Object(p.checkIsTomorrow)(t.cutOffTime)):2===t.shippingType&&t.cutOffTime?i=t.cutOffTime:5===t.shippingType&&t.cutOffTime&&(i=t.cutOffTime)}));var n=setInterval((function(){var t=(new Date).getTime(),s=i-t;e.hr=s/36e5,e.hr<24&&e.hr>0&&(clearInterval(n),e.cutOffTime=i)}),1e3);e.resultShipping=null===(s=e.shippingList.filter((function(t){return 3!==t.shippingType})).sort((function(t,e){return t.eta-e.eta})))||void 0===s?void 0:null===(o=s[0])||void 0===o?void 0:o.eta}},queryPincodeAvailable:function(){this.$parent._initOmoInfo(this.successCallBack,{pincode:this.userPincode,latitude:this.position.latitude,longitude:this.position.longitude})},getAppInfo:function(){var t=this;o.a.bus.$on("trade-in-address-info",(function(e){if(e){t.appAddress=e;var i=e.split(",")[1]&&e.split(",")[1].trim();h.geocoderGetLatLng(i,(function(e){e[0]&&e[0].geometry&&e[0].geometry.location&&(t.$set(t.position,"latitude",e[0].geometry.location.lat()),t.$set(t.position,"longitude",e[0].geometry.location.lng()),t.getPincodeValue(i))}),(function(){t.getPincodeValue(i)}))}}))},getCurrentPosition:function(){return new Promise((function(t,e){window.navigator?window.navigator&&window.navigator.geolocation.getCurrentPosition((function(e){t({longitude:e.coords.longitude,latitude:e.coords.latitude})}),(function(t){e(t)}),{enableHighAccuracy:!1,timeout:5e3}):e(new Error)}))},clickDeliveryHander:function(){this.isUnfold=!this.isUnfold}}},m=(i("ZOQe"),Object(r.a)(v,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"product-station__omo-delivery"},[i("div",{staticClass:"enter-pincode"},[i("div",{staticClass:"delivery-head-box"},[i("p",{staticClass:"head-text"},[i("span",{staticClass:"font-subheading-md"},[t._v(t._s(t.$t("pickUpText.delivery")))]),t._v(" "),t.isSupportCod?i("span",{staticClass:"store-label font-note-xs"},[t._v("\n          "+t._s(t.$t("pickUpText.cod"))+"\n        ")]):t._e()])]),t._v(" "),t.isSupportDelivery&&t.shippingList&&t.shippingList.length>0?i("div",{class:["delivery-method",{"pickup-line":!t.isSupportOmo}]},[i("div",{staticClass:"pick-time flex flex-align-center"},[i("i",{staticClass:"ico ico-logistics"}),t._v(" "),t.duringDeposit?i("div",{staticClass:"font-body-xl"},[t._v("\n          "+t._s(t.depositEtaText?t.depositEtaText:t.$t("pickUpText.depositEtaText"))+"\n        ")]):i("div",{staticClass:"eta-time"},[i("p",{staticClass:"title font-body-md"},[t._v("\n            "+t._s(t.surpportThreeHourDelivery?t.$t("pickUpText.threeHourText"):t.$t("pickUpText.priority"))+"\n          ")]),t._v(" "),i("p",{staticClass:"font-body-xl"},[t._v("\n            "+t._s(t.etaTime)+"\n          ")])])]),t._v(" "),t.hr<24&&t.timeDownFlag&&t.cutOffTime&&!t.duringDeposit?i("div",{staticClass:"pick-time flex flex-align-center time-down time-down-box"},[t.surpportThreeHourDelivery?i("p",{staticClass:"ent-time font-body-xl"},[t.isCutoffTimeTomorrow?i("span",[t._v("\n            ("+t._s(t.$t("pickUpText.cutoffTimeTomorrowFront"))+"\n            "+t._s(t.formatEndTime(t.cutOffTime))+"\n            "+t._s(t.$t("pickUpText.cutoffTimeTomorrowEnd"))+")\n          ")]):i("span",[t._v("("+t._s(t.$t("pickUpText.cutoffTimeNow"))+")")])]):i("p",{staticClass:"ent-time font-body-xl"},[t._v("\n          ("+t._s(t.$t("pickUpText.orderBefore"))+" "+t._s(t.formatEndTime(t.cutOffTime))+")\n        ")])]):t._e()]):t._e(),t._v(" "),t.isSupportOmo&&t.selectSkuPincodeStoreList.length?i("nearby-store",{ref:"nearbyStoreBox",attrs:{"store-list":t.selectSkuStoreList,"pincode-store-list":t.selectSkuPincodeStoreList,"is-trade-in":t.hasFinishTradein}}):t._e(),t._v(" "),!t.isSupportDelivery||!t.shippingList||t.shippingList&&0==t.shippingList.length?i("div",{staticClass:"delivery-method unable-delivery"},[i("div",{staticClass:"pick-time flex flex-align-center"},[i("i",{staticClass:"ico ico-delivery-shipping-outline"}),t._v(" "),i("span",{staticClass:"font-body-md"},[t._v(t._s(t.$t("pickUpText.unablePinCodeDelivery"))+" ")])])]):t._e(),t._v(" "),i("div",{staticClass:"address"},[i("div",{staticClass:"address-choice-box flex",on:{click:t.showAddress}},[i("i",{staticClass:"ico ico-location-outline location-icon-pincode flex"}),t._v(" "),t.userPincode&&!t.isApp?i("p",{staticClass:"address-note font-body-lg"},[t._v("\n          "+t._s(t.$t("pickUpText.deliveryTo"))+" "+t._s(t.cityName?t.cityName+" -":"")+" "+t._s(t.userPincode)+"\n        ")]):t._e(),t._v(" "),t.userPincode||t.isApp?t._e():i("p",{staticClass:"address-note font-body-lg"},[t._v("\n          "+t._s(t.$t("pickUpText.addNewCode"))+"\n        ")]),t._v(" "),t.appAddress&&t.isApp?i("p",{staticClass:"address-note font-body-lg"},[t._v("\n          "+t._s(t.$t("pickUpText.deliveryTo"))+" "+t._s(t.appAddress)+"\n        ")]):t._e(),t._v(" "),!t.appAddress&&t.isApp?i("p",{staticClass:"address-note font-body-lg"},[t._v("\n          "+t._s(t.$t("pickUpText.addNewCode"))+"\n        ")]):t._e()])])],1)])}),[],!1,null,"ef636036",null));e.default=m.exports}}]);